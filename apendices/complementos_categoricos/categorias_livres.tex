\section{Categorias livres}

Comumente representamos uma categoria por meio de um grafo orientado tendo os objetos da categoria como vértices e os morfismos da categoria como arestas.
Apesar dessa representação bastante útil, uma categoria possui mais estrutura do que um mero grafo orientado, visto que podemos compor os morfismos de uma categoria para obtermos novos morfismos, mas não existe uma operação análoga de composição das arestas de um grafo.
Mais precisamente, toda categoria possui um grafo orientado \emph{subjacente} que esquece da estrutura algébrica da composição.
Os leitores com alguma experiência em Teoria de Categorias já devem esperar que exista também uma construção no sentido contrário por meio da qual um grafo orientado dá origem a uma categoria obtida pela adição da forma mais simples possível de morfismos que representem a composição das arestas do grafo.
A categoria assim obtida é a chamada \emph{categoria livre} gerada pelo grafo, e essa construção é o objetivo central desta seção.

Antes de continuarmos, cabe aqui um aviso sobre terminologia.
O termo \emph{grafo} é particularmente carregado na literatura matemática, e por esse motivo escolhemos usar daqui em diante o termo \emph{aljava} (tradução do inglês \emph{quiver}) no lugar de grafo orientado.

\begin{defin}\label{defin:aljava}
    Uma \textbf{aljava} consiste de uma tupla $(V,A,s,t)$, onde $V$ e $A$ são conjuntos, e $s,\,t: A \to V$ são funções.
\end{defin}

Dada uma aljava $(V,A,s,t)$, os elementos de $V$ são chamados de \textbf{vértices} da aljava, enquanto os elementos de $A$ são chamados de \textbf{arestas} da aljava.
As funções $s$ e $t$ são chamadas de funções \textbf{source} e \textbf{target}, respectivamente.
Visualmente, cada elemento $e \in A$ deve ser visualizado como uma aresta direcionada começando no vértice $s(e)$ e terminando no vértice $t(e)$.
Por vezes será mais conveniente denotarmos uma aljava simplesmente por uma letra como $Q$, e caso seja necessário nos referirmos às estruturas constituintes dessa aljava, usaremos então notações como $V(Q)$, $A(Q)$, $s_Q$ e $t_Q$.

\begin{exem}\label{exem:aljava_discreta}
    Um conjunto $X$ pode ser usado para definir uma aljava $QX$ dada pela tupla $QX \coloneqq (X,X,\id_X,\id_X)$.
    Visualmente, tal aljava possui um vértice para cada elemento $x \in X$ e também uma aresta direcionada desse elemento para si mesmo formando um laço.
    A aljava $QX$ assim definida é chamada de \textbf{aljava discreta} gerado por $X$.
\end{exem}

\begin{exem}\label{exem:aljava_via_relacao}
    Seja $R \subseteq X \times X$ uma relação qualquer em um conjunto $X$.
    Podemos construir a partir dessa relação uma aljava $Q \coloneqq (X,R,s,t)$, onde $s,\,t: R \to X$ são as restriçõs das projeções canônicas associadas ao produto $X \times X$, ou seja, $s(x_1,x_2) \coloneqq x_1$ e $t(x_1,x_2) \coloneqq x_2$ para qualquer par $(x_1,x_2) \in R$.
    
    É especialmente comum considerarmos essa construção no caso em que a relação $R$ é uma pré-ordem $\leq$ no conjunto $X$, ou seja, uma relação reflexiva e transitiva.
    Nesse caso, as arestas da aljava``acompanham o sentido de crescimento'' da pré-ordem $\leq$.
\end{exem}

\begin{exem}\label{exem:aljava_oposta}
    Toda aljava $Q=(V,A,s,t)$ dá origem a uma \textbf{aljava oposta} $Q^{\mathsf{op}}$ definida pela tupla $(V,A,t,s)$.
    Visualmente, $Q^{\mathsf{op}}$ possui os mesmos vértices de $Q$, mas com as arestas indo no sentido oposto.
\end{exem}

\begin{exem}\label{exem:aljava_via_espaco}
    Seja $X$ um espaço topológico qualquer, e considere o conjunto\footnote{É verdade que também podemos considerar $X^I$ como um espaço equipado com a topologia compacto-aberto, por exemplo, mas aqui não existe essa necessidade.} $X^I$ formado por todas as funções contínuas do tipo $I \to X$, onde $I$ denota o intervalo unitário $[0,1]$.
    Podemos considerar as funções de avaliação $e_0,\, e_1: X^I \to X$ dadas por $e_0(\gamma) \coloneqq \gamma(0)$ e $e_1(\gamma) \coloneqq \gamma(1)$ para todo $\gamma \in X^{I}$.
    A tupla $PX \coloneqq (X,X^I,e_0,e_1)$ define então a \textbf{aljava de caminhos} do espaço $X$.
\end{exem}

\begin{exem}\label{exem:aljava_subjacente_categoria}
    Seja $\mathsf{C}$ uma categoria pequena.
    Se $\dom,\,\cod: \Mor(\mathsf{C}) \to \mathsf{C}$ são as funções que associam a cada morfismo de $\mathsf{C}$ seu domínio e codomínio, respectivamente, então a tupla $U(\mathsf{C}) \coloneqq (\mathsf{C},\Mor(\mathsf{C}),\dom,\cod)$ define a \textbf{aljava subjacente à categoria} $\mathsf{C}$.
\end{exem}

\begin{defin}\label{defin:morfismo_aljavas}
    Dadas duas aljavas $Q_1$ e $Q_2$, um \textbf{morfismo de aljavas} do tipo $Q_1 \to Q_2$ é por definição um par de funções $(f: V(Q_1) \to V(Q_2),\, F: A(Q_1) \to A(Q_2))$ satisfazendo as igualdades $s_{Q_2} \circ F = f \circ s_{Q_1}$ e $t_{Q_2} \circ F = f \circ t_{Q_1}$.
\end{defin}

Assim como no caso de funtores entre categorias onde comumente usamos a mesma letra para designar a ação nos objetos e nos vértices, utilizaremos por vezes um único símbolo para designar ação de um morfismo de aljava tanto nos vértices quanto nas arestas.

\begin{exem}
    Dados dois conjuntos $X_1$ e $X_2$ e uma função $f: X_1 \to X_2$, o par $(f,f)$ define um morfismo $QX_1 \to QX_2$ entre as aljavas discretas geradas por $X_1$ e $X_2$ de acordo com o \cref{exem:aljava_discreta}.
\end{exem}

\begin{exem}
    Sejam $(X_1,R_1)$ e $(X_2,R_2)$ dois conjuntos equipados com relações, e suponha que $f: X_1 \to X_2$ seja uma função que respeita as relações, ou seja, se $(x,x') \in R_1$, então $(f(x),f(x')) \in R_2$.
    Considere as aljavas $Q_1$ e $Q_2$ associados às relações $R_1$ e $R_2$, respectivamente, conforme discutido no \cref{exem:aljava_via_relacao}.
    Como $f$ respeita as relações $R_1$ e $R_2$, a função produto $f \times f: X_1 \times X_1 \to X_2 \times X_2$ satisfaz $(f \times f)(R_1) \subseteq R_2$, portanto podemos considerar a função restrita
    \begin{displaymath}
        f \times f \rvert_{R_1}: R_1 \to R_2.
    \end{displaymath}
    O par de funções $(f,f \times f\rvert_{R_1})$ define então um morfismo de aljavas do tipo $Q_1$ para $Q_2$.
    
    No caso em que $R_1$ e $R_2$ são relações de pré-ordem $\leq_1$ e $\leq_2$, a condição de $f$ respeitar as relações diz que, se $x \leq_1 x'$, então $f(x) \leq_2 f(x')$; ou seja, $f$ é uma função monótona.
    Segue da discussão acima que funções monótonas entre conjuntos pré-ordenados dão origem a morfismos entre as aljavas obtidas a partir deles.
\end{exem}

\begin{exem}
    Uma função contínua $f: X \to Y$ entre espaços topológicos dá origem a uma função de pushforward $X^f: X^I \to Y^{I}$ definida por $X^f(\gamma) \coloneqq f \circ \gamma$ para todo $\gamma \in X^{I}$.
    O par $(f,X^f)$ define então um morfismo aljavas
    \begin{displaymath}
        (f,X^f): (X,X^I,e^X_0,e^X_1) \to (Y,Y^I,e^Y_0,e^Y_1)
    \end{displaymath}
    entre as alajvas de caminhos definidas no \cref{exem:aljava_via_espaco}.
    De fato, para qualquer $\gamma \in X^I$ por um lado temos
    \begin{displaymath}
        e^Y_0(X^f(\gamma)) = e^Y_0(f \circ \gamma) = f(\gamma(0)) = f(e^X_0(\gamma)),
    \end{displaymath}
    enquanto por outro temos
    \begin{displaymath}
        e^Y_1(X^f(\gamma)) = e^Y_1(f \circ \gamma) = f(\gamma(1)) = f(e^X_1(\gamma)).
    \end{displaymath}
\end{exem}

\begin{exem}\label{exem:funtor_induz_morfismo_de_aljavas}
    Lembre-se que um funtor $F: \mathsf{C} \to \mathsf{D}$ é dado por uma função $F: \mathsf{C} \to \mathsf{D}$ a nível de objetos e também por uma função $\Mor(F): \Mor(\mathsf{C}) \to \Mor(\mathsf{D})$ a nível de morfismos a qual é compatível com as funções de domínio e codomínio de cada uma das categorias e também com as respectivas operações de composição.
    A compatibilidade com as funções de domínio e codomínio, em particular, faz com que o par $(F,\Mor(F))$ defina um morfismo do tipo $U(\mathsf{C}) \to U(\mathsf{D})$ entre as aljavas subjacentes às categorias discutidas no \cref{exem:aljava_subjacente_categoria}.
\end{exem}

Dois morfismos de aljavas $(f_1,F_1): Q_1 \to Q_2;$ e $(f_2,F_2): Q_2 \to Q_3$ podem ser compostos para definir um outro morfismo de aljavas $(f_2,F_2) \circ (f_1,F_1): Q_1 \to Q_3$ pela regra
\begin{displaymath}
    (f_2,F_2) \circ (f_1,F_1) \coloneqq (f_2 \circ f_1,F_2 \circ F_1).
\end{displaymath}
Além disso, toda aljava $Q$ tem associada a ela um morfismo identidade $\id_Q: Q \to Q$ dado pelo par $(\id_{V(Q)},\id_{A(Q)})$.
Uma conta simples mostra que o morfismo $\id_Q$ realmente age como uma identidade para a composição de morfismos de grafos orientados introduzida acima.
Em resumo, temos uma categoria $\mathsf{Alj}$ formada por aljavas e morfismos entre elas
Diversas das construções introduzidas nos exemplos anteriores podem ser estendidas para funtores definidos na categoria $\mathsf{Alj}$, ou então tomando valores nela.

\begin{exem}
    Considere a categoria $\mathsf{SetRel}$ cujos objetos são conjuntos equipados com alguma relação e cujos morfismos são funções preservando tais relações.\footnote{É tentador usar o nome $\mathsf{Rel}$ para tal categoria, mas é comum na literatura usar esse nome para identificar a categoria onde relações aparecem como \emph{morfismos} entre conjuntos.}
    Vimos no \cref{exem:aljava_via_relacao} que todo conjunto equipado com uma relação $(X,\leq)$ dá origem a uma aljava, e que funções preservando tais relações dão origem a morfismos entre as aljavas correspondentes.
    Uma conta simples mostra que essa construção preserva composições e morfismos identidade, definindo portanto um funtor $F: \mathsf{SetRel} \to \mathsf{Alj}$.
    
    Existe também um funtor no sentido contrário $\mathsf{Alj} \to \mathsf{SetRel}$.
    Dada uma aljava $Q$, definimos uma relação $R_Q$ no conjunto de vértices $V(Q)$ da aljava por meio da fórmula
    \begin{displaymath}
        R_Q \coloneqq \{(u,v) \in V(Q) \times V(Q) \mid s_Q(e) = u \text{ e } t_Q(e) = v \text{ para alguma aresta } e \in A(Q)\}.
    \end{displaymath}
    Note também que, se $(f,F): Q_1 \to Q_2$ é um morfismo de aljavas, então a função a nível dos vértices $f: V(Q_1) \to V(Q_2)$ preservas as relações $R_{Q_1}$ e $R_{Q_2}$.
    De fato, se $(u,v) \in R_{Q_1}$, então existe alguma aresta $e \in A(Q_1)$ tal que $s_{Q_1}(e) = u$ e $t_{Q_1}(e) = v$.
    Note então que pelas condições de compatibilidade entre $f$, $F$ e as funções source e target das aljavas temos
    \begin{displaymath}
        s_{Q_2}(F(e)) = f(s_{Q_1}(e)) = f(u)
        \quad \text{e} \quad
        t_{Q_2}(F(e)) = f(t_{Q_1}(e)) = f(v),
    \end{displaymath}
    portanto $(f(u),f(v)) \in R_{Q_2}$.
    Isso nos permite então definir um funtor $\mathsf{Alj} \to \mathsf{SetRel}$ como mencionado.
\end{exem}

\begin{exem}\label{exem:funtor_esquecimento_cat_aljava}
    Vimos no \cref{exem:aljava_subjacente_categoria} que toda categoria pequena $\mathsf{C}$ possui uma aljava subjacente $U(\mathsf{C})$ e vimos também no \cref{exem:funtor_induz_morfismo_de_aljavas} que um funtor $F: \mathsf{C} \to \mathsf{D}$ induz um morfismo $U(F) \coloneqq (F,\Mor(F)): U(\mathsf{C}) \to U(\mathsf{D})$ entre as aljavas subjacentes.
    Essas duas construções combinadas nos permitem definir um \emph{funtor de esquecimento} $U: \mathsf{Cat} \to \mathsf{Alj}$ definido na categoria de categorias pequenas e tomando valores na categoria de aljavas.
    Usamos o termo funtor de esquecimento pois ao passar da categoria $\mathsf{C}$ para sua aljava subjacente $U(\mathsf{C})$ nos esquecemos da estrutura de composição de morfismos existente na categoria original.
\end{exem}

Nosso interesse é investigar a existência de um funtor no sentido contrário $\mathsf{Alj} \to \mathsf{Cat}$ que associa a cada aljava uma categoria onde podemos compor formalmente suas arestas da forma mais simples possível.
A existência de tal funtor está ligada à existência de categorias livres gerados por aljavas que definimos agora.

\begin{defin}\label{defin:categoria_livre}
    Dada uma aljava $Q$, uma \textbf{categoria livre gerada por $Q$} é um par $(\mathsf{C},i)$, onde $\mathsf{C}$ é uma categoria pequena, e $i: G \to U(\mathsf{C})$ é um morfismo de aljavas satisfazendo a seguinte propriedade universal: se $\mathsf{D}$ é outra categoria pequena qualquer, e $j: G \to U(\mathsf{D})$ é um morfismo de aljavas, então existe um único funtor $F: \mathsf{C} \to \mathsf{D}$ tal que $U(F) \circ i = j$.
    \begin{displaymath}
        \begin{tikzcd}
            U(\mathsf{C})
            \arrow[r, dashed, "U(F)"]
            & U(\mathsf{D})
            \\ G
            \arrow[u, "i"]
            \arrow[ru, "j" swap]
        \end{tikzcd}
    \end{displaymath}
\end{defin}

Tendo em mãos a definição de uma categoria livre, começaremos a caminhar agora em direção à construção de um modelo explícito para uma categoria livre.
Dado um natural $n \in \mathbb{N}$, considere a aljava $[n]$ definida da seguinte maneira: o conjunto de vértices é por definição $V([n]) \coloneqq \{0,\dots,n\}$, enquanto o conjunto de arestas é por definição $A([n]) \coloneqq \{(k,k+1) \mid 0 \leq k \leq n-1\}$.
As funções source e target são então restrições das projeções canônicas associadas ao produto $\{0,\dots,n\} \times \{0,\dots,n\}$, ou seja, temos
\begin{displaymath}
    s(k,k+1) \coloneqq k
    \quad \text{e} \quad
    t(k,k+1) \coloneqq k+1
\end{displaymath}
para todo $0 \leq k \leq n-1$.
Visualmente, $[n]$ possui $n+1$ vértices rotulados pelos números o conjunto $\{0,\dots,n\}$ e $n$ vértices, sendo que cada vértice liga um número desse conjunto ao seu sucessor como mostrado na figura abaixo.
Note, em particular, que a aljava $[0]$ consiste de um único vértice $0$ sem nenhuma aresta.

\begin{figure}[h]
    \centering
    \begin{tikzpicture}
        \node (zero) [circle,draw] {0};
        \node (one) [circle,draw,right=of zero] {1};
        \node (two) [circle,draw,right=of one] {2};
        \node (dots) [circle,right=of two] {$\cdots$};
        \node (ultimo) [circle,draw,right=of dots] {$n$};
        
        \draw[-stealth] (zero) to (one);
        \draw[-stealth] (one) to (two);
        \draw[-stealth] (two) to (dots);
        \draw[-stealth] (dots) to (ultimo);
    \end{tikzpicture}
    \caption{Representação visual da aljava $[n]$.}
    \label{fig:aljava_ordinal}
\end{figure}

\begin{obs}
    A aljava $[n]$ introduzida acima é \emph{diferente} da aljava associada ao conjunto parcialmente ordenado $(\{0,\dots,n\},\leq)$ como no \cref{exem:aljava_via_relacao}!
    Enquanto a primeira possui arestas apenas entre vértices sucessivos, a segunda possui arestas ligando dois vértices $m$ e $n$ sempre que $m \leq n$, ou seja, a segunda possui uma qunatidade bem maior de vértices.
    Em particular, a segunda aljava possui arestas formando laços, já que a relação $\leq$ é reflexiva, enquanto a primeira aljava não possui nenhum laço como é evidente de sua definição.
    A figura \cref{fig:aljava_ordinal_versus_aljava_poset} ilustra explicitamente a diferença entre a aljava $[2]$ e a aljava obtida a partir do conjunto $\{0,1,2\}$ munido de sua ordem parcial usual.
    
    \begin{figure}
        \centering
        \begin{tikzpicture}[->,>=stealth]
            \node (zero) [circle,draw] {0};
            \node (one) [circle,draw,right=of zero] {1};
            \node (two) [circle,draw,right=of one] {2};
            
            \path
            (zero) edge (one)
            (one) edge (two);
            
            \begin{scope}[xshift=6cm]
                \node (zero) [circle,draw] {0};
                \node (one) [circle,draw,right=of zero] {1};
                \node (two) [circle,draw,right=of one] {2};
                
                \path
                (zero) edge (one)
                (zero) edge [out=120,in=60,loop]
                (zero) edge [bend right] (two)
                (one) edge (two)
                (one) edge [out=120,in=60,loop] (one)
                (two) edge [out=120,in=60,loop] (two);
            \end{scope}
        \end{tikzpicture}
        \caption{Comparação entre a aljava $[2]$, representada à esquerda, e a aljava associada ao conjunto parcialmente ordenado $\{0,1,2\}$, representada à direita.}
        \label{fig:aljava_ordinal_versus_aljava_poset}
    \end{figure}
\end{obs}

%TODO: Adicionar uma figura ilustrando visualmente as diferenças entre as duas aljavas.

Definimos um \textbf{caminho de comprimento $n+1$} em uma aljava $Q$ como sendo um morfismo de aljavas $\gamma: [n] \to Q$.
A justificativa para a terminologia é que a aljava $[n]$ possui $n+1$ vértices, portanto o morfismo $\gamma$ seleciona $n+1$ vértices de $Q$ conectados por uma sequência de arestas.

A ideia básica para construirmos uma categoria a partir de uma aljava é que, embora não possamos compor duas arestas consecutivas de uma aljava de forma a obtermos uma \emph{outra aresta}, podemos compor caminhos de comprimentos quaisquer, portanto podemos reinterpretar arestas como caminhos de comprimento $2$ na aljava e encarar sua composição como sendo um caminho de comprimento $3$.
O fato que nos permite compor caminhos é que duas aljavas $[m]$ e $[n]$ podem ser coladas ao longo de seus pontos extremos para formarem uma aljava do tipo $[m+n]$.
A melhor maneira de formalizarmos essa ideia de colagem é por meio de um pushout na categoria de aljavas, mas para isso precisamos antes introduzir alguns morfismos específicos.

Dados dois números naturais $m$ e $n$ tais que $m \leq n$, considere o morfismo de aljavas $\iota_{m,n}: [m] \to [n]$ definido da seguinte maneira: nos vértices de $[m]$ temos $\iota_{m,n}(k) \coloneqq k$ para todo $k \in \{0,\dots,m\}$, enquanto nas arestas de $[m]$ temos $\iota_{m,n}(k,k+1) \coloneqq (k,k+1)$ para qualquer $k \in \{0,\dots,m-1\}$.
Visualmente, $\iota_{m,n}$ inclui a aljava $[m]$ no \emph{segmento inicial} da aljava $[n]$ formado pelos $m+1$ primeiros vértices e todas as arestas entre eles.
Considere também o morfismo $\theta_{m,n}: [m] \to [n]$ definido da seguinte forma: nos vértices temos $\theta_{m,n}(k) \coloneqq k+n-m$ para todo $k \in \{0,\dots,m\}$, enquanto nas arestas temos $\theta_{m,n}(k,k+1) \coloneqq (k+n-m,k+n-m+1)$ para todo $k \in \{0,\dots,m-1\}$.
Visualmente, $\theta_{m,n}$ inclui a aljava $[m]$ no \emph{segmento terminal} da aljava $[n]$ formado pelos seus últimos $m+1$ vértices e todas as arestas entre eles.

Note que, quando $m=0$, o morfismo $\iota_{0,n}$ destaca o vértice inicial de $[n]$, e o morfismo $\theta_{0,n}$ destaca o último terminal de $[n]$.

O lema abaixo descreve o processo de colagem de aljavas mencionado anteiormente em termos de um pushout.

\begin{lema}\label{lema:pushout_aljavas_ordinais}
    O diagrama comutativo abaixo define um pushout na categoria $\mathsf{Alj}$.
    \begin{equation}\label{eq:pushout_aljavas_ordinais_diag}
        \begin{tikzcd}[column sep=1.35cm]
            {[0]}
            \arrow[r,"{\theta_{0,m}}"]
            \arrow[d, "{\iota_{0,n}}" swap]
            & {[m]}
            \arrow[d, "{\iota_{m,m+n}}"]
            \\ {[n]}
            \arrow[r, "{\theta_{n,m+n}}" swap]
            & {[m+n]}
        \end{tikzcd}
    \end{equation}
\end{lema}

\begin{proof}
    Note primeiro que o diagrama acima é realmente comutativo.
    No único vértice $0$ da aljava $[0]$ temos por um lado
    \begin{displaymath}
        \iota_{m,m+n}(\theta_{0,m}(0))
        = \iota_{m,m+n}(0+m-0)
        = \iota_{m,m+n}(m)
        = m
    \end{displaymath}
    e por outro
    \begin{displaymath}
        \theta_{n,m+n}(\iota_{0,n}(0))
        = \theta_{n,m+n}(0)
        = 0 + (m+n) - n
        = m.
    \end{displaymath}
    
    Suponha agora que $Q$ seja uma aljava qualquer e que tenhamos morfismos $f: [m] \to Q$ e $g: [n] \to Q$ tais que $f \circ \theta_{0,m} = g \circ \iota_{0,n}$.
    Nosso objetivo é mostrar a existência de um único morfismo $\phi: [m+n] \to Q$ fazendo comutar o diagrama abaixo.
    \begin{displaymath}
        \begin{tikzcd}[column sep=1.35cm]
            {[0]}
            \arrow[r,"{\theta_{0,m}}"]
            \arrow[d, "{\iota_{0,n}}" swap]
            & {[m]}
            \arrow[d, "{\iota_{m,m+n}}"]
            \arrow[rdd, bend left=45, "f"]
            \\ {[n]}
            \arrow[r, "{\theta_{n,m+n}}" swap]
            \arrow[rrd, bend right=45, "g" swap]
            & {[m+n]}
            \arrow[rd, dashed, "\phi" description]
            \\ & & Q
        \end{tikzcd}
    \end{displaymath}
    Nos vértices de $[m+n]$ definimos
    \begin{displaymath}
        \phi(k) \coloneqq
        \begin{cases}
            f(k), & \text{se } 0 \leq k \leq m; \\
            g(k-m), & \text{se } m \leq k \leq m+n.
        \end{cases}
    \end{displaymath}
    Veja que $\phi$ está bem-definida nos vértices pois a condição de comutatividade $f \circ \theta_{0,m} = g \circ \iota_{0,n}$ diz precisamente que vale a igualdade $f(m) = g(0)$.
    A definição de $\phi$ nas arestas é a esperada: utilizamos o morfismo $f$ nas $m$ primeiras arestas e o morfismo $g$ nas $n$ últimas.
    Explicitamente, definimos
    \begin{displaymath}
        \phi(k,k+1) \coloneqq
        \begin{cases}
            f(k,k+1), & \text{se } 0 \leq k \leq m-1; \\
            g(k-m,k-m+1), & \text{se } m \leq k \leq m+n-1.
        \end{cases}
    \end{displaymath}
    
    Uma conta direta usando o fato de $f$ e $g$ morfismos de aljavas mostra que $\phi$ é também um morfismo de aljavas.
    Resta agora mostrarmos que $\phi$ é na verdade o único morfismo possível satisfazendo as condições de comutatividade em questão.
    Suponha então que $\psi: [m+n] \to Q$ seja um outro morfismo de aljavas tal que $\psi \circ \iota_{m,m+n} = f$ e $\psi \circ \theta_{n,m+n} = g$.
    Dado um vértice $k \in \{0,\dots,m+n\}$ qualquer, se $0 \leq k \leq m$, então
    \begin{displaymath}
        \psi(k) = \psi(\iota_{m,m+n}(k)) = f(k) = \phi(k),
    \end{displaymath}
    e se $m \leq k \leq m+n$, então
    \begin{displaymath}
        \psi(k) = \psi((k-m)+m) = \psi(\theta_{n,m+n}(k-m)) = g(k-m) = \phi(k);
    \end{displaymath}
    portanto $\psi$ coincide com $\phi$ nos vértices.
    Dada agora uma aresta $(k,k+1)$ de $[m+n]$, se $0 \leq k \leq m-1$ temos
    \begin{displaymath}
        \psi(k,k+1) = \psi(\iota_{m,m+n}(k,k+1)) = f(k,k+1) = \phi(k,k+1),
    \end{displaymath}
    e se $m \leq k \leq m+n-1$ temos
    \begin{align*}
        \psi(k,k+1)
        & = \psi((k-m)+m,(k-m+1)+m) \\
        & = \psi(\theta_{n,m+n}(k-m,k-m+1)) \\
        & = g(k-m,k-m+1) \\
        & = \phi(k,k+1);
    \end{align*}
    portanto $\psi$ coincide com $\phi$ nos vértices também como queríamos mostrar.
\end{proof}

Temos agora em mãos todos os ingredientes necessários para construirmos uma categoria que depois mostraremos que satisfaz a propriedade universal que caracteriza a categoria livremente gerada por uma aljava.

Dada uma aljava qualquer $Q$, considere a categoria $\mathsf{FQ}$ tendo como objetos os vértices $V(Q)$ da aljava inicial $Q$ e tendo como morfismos entre dois objetos $a,\, b \in V(Q)$ o conjunto definido por
\begin{equation}\label{eq:morfismo_categoria_livre_defin}
    \Hom_{\mathsf{FQ}}(a,b) \coloneqq \bigcup_{n \in \mathbb{N}} \{F: [n] \to Q \mid F(0) = a \text{ e } F(n) = b\};
\end{equation}
ou seja, um morfismo de $a$ para $b$ em $\mathsf{FQ}$ é um caminho de tamanho qualquer na aljava $Q$ começando em $a$ e terminando em $b$.

Vamos definir uma operação de composição nesses conjuntos de morfismos.
Dados três objetos $a$, $b$ e $c$ em $\mathsf{FQ}$, se $F:[m] \to Q$ é um morfismo de $a$ para $b$, e $G:[n] \to Q$ é um morfismo de $b$ para $c$, como $F(m) = b = G(0)$, os morfismos compostos $F \circ \theta_{0,m},\, G \circ \iota_{0,n}: [0] \to Q$ são iguais, portanto existe um único morfismo de aljavas $G \star F: [m+n] \to Q$ fazendo comutar o diagrama mostrado abaixo graças ao \cref{lema:pushout_aljavas_ordinais}.
\begin{displaymath}
    \begin{tikzcd}
        {[0]}
        \arrow[r, "{\theta_{0,m}}"]
        \arrow[d, "{\iota_{0,n}}" swap]
        & {[m]}
        \arrow[d, "\iota_{m,m+n}"]
        \arrow[rdd, bend left=45, "F"]
        \\ {[n]}
        \arrow[r, "{\theta_{n,m+n}}" swap]
        \arrow[rrd, bend right=45, "G" swap]
        & {[m+n]}
        \arrow[rd, dashed, "G \star F" description]
        \\ & & Q
    \end{tikzcd}
\end{displaymath}
Veja que pelas condições de comutatividade temos
\begin{displaymath}
    (G \star F)(0) = [(G \star F) \circ \iota_{m,m+n}](0) = F(0) = a
\end{displaymath}
e também
\begin{displaymath}
    (G \star F)(m+n) = [(G \star F) \circ \theta_{n,m+n}](n) = G(n) = c;
\end{displaymath}
ou seja, $G \star F$ define um caminho em $Q$ começando em $a$ e terminando em $c$, portanto um morfismo de $a$ para $c$ em $\mathsf{FQ}$ conforme definido em \eqref{eq:morfismo_categoria_livre_defin}.
É este morfismo $G \star F$ que consideraremos como sendo a composição dos morfismos $F$ e $G$.
Note que pela construção dada no \cref{lema:pushout_aljavas_ordinais} podemos descrever $G \star F$ explictamente: em um vértice $k \in \{0,\dots,m+n\}$ qualquer temos
\begin{displaymath}
    (G \star F)(k) =
    \begin{cases}
        F(k), & \text{se } 0 \leq k \leq m, \\
        G(k-m), & \text{se } m \leq k \leq m+n;
    \end{cases}
\end{displaymath}
e em uma aresta $(k,k+1)$ qualquer temos
\begin{displaymath}
    (G \star F)(k,k+1) =
    \begin{cases}
        F(k,k+1), & \text{se } 0 \leq k \leq m-1, \\
        G(k-m,k-m+1), & \text{se } m \leq k \leq m+n-1.
    \end{cases}
\end{displaymath}

Dado um objeto $a \in \mathsf{FQ}$ qualquer, considere o morfismo de aljavas $p_a: [0] \to Q$ que mapeia o único vértice $0 \in [0]$ para $a$.
Esse morfismo define um caminho na aljava $Q$ começando e terminando no vértice $a$, ou seja, um morfismo do tipo $a \to a$ na categoria $FQ$.
Vamos mostrar que esse morfismo é uma identidade para a operação de composição definida acima.
Considere um morfismo do tipo $a \to b$ dado por um caminho $G:[n] \to Q$ começando em $a$ e terminando em $b$ e vamos mostrar que vale a igualdade $G \star p_a = G$.
Uma maneira de fazermos isso é simplesmente compararmos diretamente ambos os lados usando a descrição explícita para a composição $G \star p_a$ dada acima, mas também podemos mostrar essa igualdade usando a unicidade que caracteriza o morfismo $G \star p_a$.
Mais precisamente, $G \star p_a$ é o \emph{único} morfismo de alajvas do tipo $[0+n] = [n] \to Q$ que faz comutar o diagrama mostrado abaio.
\begin{displaymath}
    \begin{tikzcd}
        {[0]}
        \arrow[r, "{\theta_{0,0}}"]
        \arrow[d, "{\iota_{0,n}}" swap]
        & {[0]}
        \arrow[d, "\iota_{0,n}"]
        \arrow[rdd, bend left=45, "p_a"]
        \\ {[n]}
        \arrow[r, "{\theta_{n,n}}" swap]
        \arrow[rrd, bend right=45, "G" swap]
        & {[n]}
        \arrow[rd, dashed, "G \star p_a" description]
        \\ & & Q
    \end{tikzcd}
\end{displaymath}
Segue dessa unicidade que caracteriza $G \star p_a$ que a validade da igualdade $G \star p_a = G$ é equivalente à validade das igualdades
\begin{displaymath}
    \begin{cases}
        G \circ \iota_{0,n} = p_a, \\
        G \circ \theta_{n,n} = G.
    \end{cases}
\end{displaymath}
A primeira dessas igualdade é verdadeira pois $G$ é por hipótese um caminho começando no vértice $a$, enquanto a segunda é verdadeira pois o morfismo $\theta_{n,n}$ é igual ao morfismo identidade $\id_{[n]}$.
Considere agora um morfismo do tipo $z \to a$ na categoria $FQ$ dado por um caminho $F:[m] \to Q$ começando em $z$ e terminando em $a$.
A composição $p_a \star F: [m] \to Q$ é por definição o único morfismo de aljavas do tipo $[m] \to Q$ fazendo comutar o diagrama abaixo.
\begin{displaymath}
    \begin{tikzcd}
        {[0]}
        \arrow[r, "{\theta_{0,m}}"]
        \arrow[d, "{\iota_{0,0}}" swap]
        & {[m]}
        \arrow[d, "\iota_{m,m}"]
        \arrow[rdd, bend left=45, "F"]
        \\ {[0]}
        \arrow[r, "{\theta_{0,m}}" swap]
        \arrow[rrd, bend right=45, "p_a" swap]
        & {[m]}
        \arrow[rd, dashed, "p_a \star F" description]
        \\ & & Q
    \end{tikzcd}
\end{displaymath}
A igualdade $p_a \star F = F$ seguirá então se mostrarmos que $F$ satisfaz as igualdades
\begin{displaymath}
    \begin{cases}
        F \circ \iota_{m,m} = F, \\
        F \circ \theta_{0,m} = p_a.
    \end{cases}
\end{displaymath}
A primeira das igualdades acima é válida pois o morfismo $\iota_{m,m}$ é igual ao morfismo identidade $\id_{[m]}$, enquanto a segunda é válida pois o caminho $F$ termina no vértice $a$ por hipótese.
Concluímos enfim que o morfismo do tipo $a \to a$ em $\mathsf{FQ}$ dado pelo caminho $p_a: [0] \to Q$ é uma identidade para a operação de composição $\star$ em questão.

Vejamos agora a questão da associatividade da operação de composição.
Considere três objetos $a$, $b$, $c$ e $d$ de $\mathsf{FQ}$ juntamento com morfismos do tipo $a \to b$, $b \to c$ e $c \to d$ dados, respectivamente, por caminhos $F: [\ell] \to Q$, $G: [m] \to Q$ e $H: [n] \to Q$.
Os morfismos $G \star F$ e $H \star G$ são caracterizados como os únicos morfismos de seus respectivos tipos que fazem comutar os diagramas abaixo,
\begin{equation}\label{eq:associatividade_cat_livre_diag_1}
    \begin{tikzcd}
        {[0]}
        \arrow[r, "{\theta_{0,\ell}}"]
        \arrow[d, "{\iota_{0,m}}" swap]
        & {[\ell]}
        \arrow[d, "{\iota_{\ell,\ell+m}}"]
        \arrow[rdd, bend left=45, "F"]
        \\ {[m]}
        \arrow[r, "{\theta_{m,\ell+m}}" swap]
        \arrow[rrd, bend right=45, "G" swap]
        & {[\ell+m]}
        \arrow[rd, dashed, "G \star F" description]
        \\ & & Q
    \end{tikzcd}
    \qquad
    \begin{tikzcd}
        {[0]}
        \arrow[r, "{\theta_{0,m}}"]
        \arrow[d, "{\iota_{0,n}}" swap]
        & {[m]}
        \arrow[d, "{\iota_{m,m+n}}"]
        \arrow[rdd, bend left=45, "G"]
        \\ {[n]}
        \arrow[r, "{\theta_{n,m+n}}" swap]
        \arrow[rrd, bend right=45, "H" swap]
        & {[m+n]}
        \arrow[rd, dashed, "H \star G" description]
        \\ & & Q
    \end{tikzcd}
\end{equation}
enquanto os morfismos $H \star (G \star F)$ e $(H \star G) \star F$ são os únicos que fazem comutar os dois diagramas mostrados abaixo.
\begin{equation}\label{eq:associatividade_cat_livre_diag_2}
    \begin{tikzcd}[column sep=1.25cm]
        {[0]}
        \arrow[r, "{\theta_{0,\ell+m}}"]
        \arrow[d, "{\iota_{0,n}}" swap]
        & {[\ell+m]}
        \arrow[d, "{\iota_{\ell+m,\ell+m+n}}"]
        \arrow[rdd, bend left=45, "G \star F"]
        \\ {[n]}
        \arrow[r, "{\theta_{n,\ell+m+n}}" swap]
        \arrow[rrd, bend right=45, "H" swap]
        & {[\ell+m+n]}
        \arrow[rd, dashed, "H \star (G \star F)" description]
        \\ & & Q
    \end{tikzcd}
    \quad
    \begin{tikzcd}[column sep=1.35cm]
        {[0]}
        \arrow[r, "{\theta_{0,\ell}}"]
        \arrow[d, "{\iota_{0,m+n}}" swap]
        & {[\ell]}
        \arrow[d, "{\iota_{\ell,\ell+m+n}}"]
        \arrow[rdd, bend left=45, "F"]
        \\ {[m+n]}
        \arrow[r, "{\theta_{m+n,\ell+m+n}}" swap]
        \arrow[rrd, bend right=45, "H \star G" swap]
        & {[\ell+m+n]}
        \arrow[rd, dashed, "(H \star G) \star F" description]
        \\ & & Q
    \end{tikzcd}
\end{equation}
Graças à unicidade que caracteriza $(H \star G) \star F$, a igualdade $H \star (G \star F) = (H \star G) \star F$ desejada seguirá se mostrarmos a validade das igualdades
\begin{displaymath}
    \begin{cases}
        (H \star (G \star F)) \circ \iota_{\ell,\ell+m+n} = F, \\
        (H \star (G \star F)) \circ \theta_{m+n,\ell+m+n} = H \star G.
    \end{cases}
\end{displaymath}
No caso da primeira igualdade, veja inicialmente que o morfismo $\iota_{\ell,\ell+m+n}: [\ell] \to [\ell+m+n]$ pode ser reescrito como a composição
\begin{displaymath}
    \iota_{\ell,\ell+m+n} = \iota_{\ell+m,\ell+m+n} \circ \iota_{\ell,\ell+m}.
\end{displaymath}
Usando isso vemos então que
\begin{align*}
    (H \star (G \star F)) \circ \iota_{\ell,\ell+m+n}
    & = (H \star (G \star F)) \circ \iota_{\ell+m,\ell+m+n} \circ \iota_{\ell,\ell+m} \\
    & = (G \star F) \circ \iota_{\ell,\ell+m}
    \tag{por \eqref{eq:associatividade_cat_livre_diag_2}} \\
    & = F
    \tag{por \eqref{eq:associatividade_cat_livre_diag_1}}.
\end{align*}
Já no caso da segunda igualdades, graças à unicidade que caracteriza o morfismo $H \star G$, ``basta'' mostrarmos a validade das igualdades abaixo.
\begin{displaymath}
    \begin{cases}
        (H \star (G \star F)) \circ \theta_{m+n,\ell+m+n} \circ \theta_{n,m+n} = H, \\
        (H \star (G \star F)) \circ \theta_{m+n,\ell+m+n} \circ \iota_{m,m+n} = G.
    \end{cases}
\end{displaymath}
No primeiro caso, como vale a igualdade
\begin{displaymath}
    \theta_{m+n,\ell+m+n} \circ \theta_{n,m+n}
    = \theta_{n,\ell+m+n}
\end{displaymath}
temos a sequência de igualdades
\begin{align*}
    (H \star (G \star F)) \circ \theta_{m+n,\ell+m+n} \circ \theta_{n,m+n}
    & = (H \star (G \star F)) \circ \theta_{n,\ell+m+n} \\
    & = H. \tag{por \eqref{eq:associatividade_cat_livre_diag_2}}
\end{align*}
Por fim, para a segunda igualdade, veja inicialmente que vale a condição de comutatividade
\begin{displaymath}
    \theta_{m+n,\ell+m+n} \circ \iota_{m,m+n}
    = \iota_{\ell+m,\ell+m+n} \circ \theta_{m,\ell+m}.
\end{displaymath}
Usando isso vemos então que
\begin{align*}
    (H \star (G \star F)) \circ \theta_{m+n,\ell+m+n} \circ \iota_{m+n,\ell+m+n}
    & = (H \star (G \star F)) \circ \iota_{\ell+m,\ell+m+n} \circ \theta_{m,\ell+m} \\
    & = (G \star F) \circ \theta_{m,\ell+m},
    \tag{por \eqref{eq:associatividade_cat_livre_diag_2}} \\
    & = G.
    \tag{por \eqref{eq:associatividade_cat_livre_diag_1}}
\end{align*}

O raciocínio acima mostra a associatividade da operação de composição $\star$ definida e nos permite concluir enfim que $\mathsf{FQ}$ define de fato uma categoria.
Fica claro da definição que $\mathsf{FQ}$ é uma categoria localmente pequena e que ela possui um conjunto de objetos, sendo portanto uma categoria pequena.

Vamos agora estabelecer uma relação entre a aljava inicial $Q$ e a aljava $U(\mathsf{FQ})$ subjacente à categoria $\mathsf{FQ}$ que acabamos de construir.
Veja que, como o conjunto de objetos de $\mathsf{FQ}$ foi definido como o conjunto de vértices de $Q$, as aljavas $Q$ e $U(\mathsf{FQ})$ possuem o mesmo conjunto de vértices.
Lembrando que o conjunto de arestas de $U(\mathsf{FQ})$ é por definição o conjunto de morfismos de $\mathsf{FQ}$, podemos definir uma função $i: A(Q) \to A(U(\mathsf{FQ}))$ que mapeia uma aresta $e$ da aljava $Q$ para o morfismo (= caminho) $i_e: [1] \to Q$ dado por $i_e(0) \coloneqq s(e)$, $i_e(1) \coloneqq t(e)$ e $i_e(0,1) \coloneqq e$.
Essa função $i_e$ não faz nada mais do que reinterpretar uma aresta de $Q$ como um caminho de comprimento $2$.
O par $(\id_{V(Q)},i)$ define então um morfismo de aljavas $Q \to U(\mathsf{FQ})$ o qual denotaremos simplesmente por $i$.

% TODO: Pensar em uma figura que ilustre a função i que reinterpreta uma aresta de Q como um caminho de comprimento 2 e, portanto, um morfismo na categoria FQ gerada a partir de Q.